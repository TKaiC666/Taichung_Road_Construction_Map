(this.webpackJsonpTaichung_Road_Construction_Map=this.webpackJsonpTaichung_Road_Construction_Map||[]).push([[0],{102:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),s=a(14),i=a.n(s),r=a(40),l=a(7),o=a(5),d=a(16),u=a(0),j=function(e){var t=e.value;return Object(u.jsxs)("div",{className:"cardMini",children:[Object(u.jsxs)("div",{className:"title",children:[Object(u.jsx)("div",{className:"state inlineBlock ".concat("\u662f"===t.workingState?"working":"notWorking"),children:"\u662f"===t.workingState?"\u65bd\u5de5\u4e2d":"\u672a\u65bd\u5de5"}),Object(u.jsx)("div",{className:"pipeType inlineBlock",children:t.pipeType})]}),Object(u.jsx)("div",{className:"title",children:Object(u.jsxs)("div",{className:"date",children:[Object(u.jsx)("span",{className:"slash",children:t.date.start.year}),Object(u.jsx)("span",{className:"slash",children:t.date.start.month}),Object(u.jsx)("span",{children:t.date.start.day}),Object(u.jsx)("i",{className:"fas fa-caret-right fa-lg"}),Object(u.jsx)("span",{className:"slash",children:t.date.end.year}),Object(u.jsx)("span",{className:"slash",children:t.date.end.month}),Object(u.jsx)("span",{children:t.date.end.day})]})}),Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:"item",children:"\u6848\u4ef6\u985e\u5225"}),Object(u.jsx)("div",{className:"data",children:t.constructionType})]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:"item",children:"\u5de5\u7a0b\u540d\u7a31"}),Object(u.jsx)("div",{className:"data",children:t.title})]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:"item",children:"\u5730\u9ede"}),Object(u.jsx)("div",{className:"data last",children:t.distriction+t.address})]})]})},m=[{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{visibility:"off"}]},{featureType:"landscape.man_made",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#f0f0f0"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{visibility:"on"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"},{color:"#ec7868"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{visibility:"on"},{color:"#3da7a7"}]},{featureType:"poi",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#ffffff"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#cccccc"}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{color:"#f9f9f9"}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{visibility:"on"},{lightness:700}]},{featureType:"water",elementType:"all",stylers:[{color:"#83cfe2"}]}],g={fillColor:"#FF7777",fillOpacity:.1,strokeColor:"#FF7777",strokeOpacity:1,strokeWeight:1,clickable:!1,draggable:!1,editable:!1,geodesic:!1,zIndex:0},h={styles:[{textSize:14,height:66,width:66,url:"/Taichung_Road_Construction_Map/img/markerclusterer/m1.png"},{textSize:14,height:66,width:66,url:"/Taichung_Road_Construction_Map/img/markerclusterer/m2.png"},{height:66,width:66,url:"/Taichung_Road_Construction_Map/img/markerclusterer/m3.png"},{height:66,width:66,url:"/Taichung_Road_Construction_Map/img/markerclusterer/m4.png"},{height:66,width:66,url:"/Taichung_Road_Construction_Map/img/markerclusterer/m5.png"}]},b=function(e){var t=Object(n.useState)(60),a=Object(o.a)(t,2),c=a[0],s=a[1],i=e.constructionsData,r=e.mapParameters,l=e.closeInfoBlock,b=e.setMapParameters,f=e.isMobile,p=e.makerMessage,O=e.userLocation,v=Object(n.useRef)(null),x=null!==i&&0!==i.length,k=Object(n.useMemo)((function(){var e=function(e){var t=10*(i.length-1)+i[i.length-1].length;return Array.from({length:t},(function(e,t){return t})).map((function(t){return 0!==i[Math.floor(t/10)][t%10].coordinate.lat&&0!==i[Math.floor(t/10)][t%10].coordinate.lng&&Object(u.jsx)(d.d,{position:{lat:Number(i[Math.floor(t/10)][t%10].coordinate.lat),lng:Number(i[Math.floor(t/10)][t%10].coordinate.lng)},onClick:function(){return function(e){var t=i[Math.floor(e/10)][e%10],a=v.current.getCenter().toJSON();b({center:a,polygon:t.coordinate.polygon,zoom:r.zoom,selectMarker:t,closeInfoWindow:!1})}(t)},clusterer:e,noClustererRedraw:!0,icon:"\u662f"===i[Math.floor(t/10)][t%10].workingState?{url:"/Taichung_Road_Construction_Map/img/marker/cone.png",scaledSize:{width:37,height:37}}:{url:"/Taichung_Road_Construction_Map/img/marker/cone_gray.png",scaledSize:{width:37,height:37}}},"marker_"+t)}))};return x&&Object(u.jsx)(d.e,{averageCenter:!0,options:h,gridSize:c,children:function(t){return e(t)}},"markerClusterer")}),[i,x,c,r,b]);return Object(u.jsxs)("div",{className:"mapContainer",children:[Object(u.jsx)("div",{id:"mapCover",className:"mapCover ".concat(null===i?"open":f?null===l&&null===p?"close":!1===l||!0===p?"open":!0===l||!1===p?"close":void 0:"close")}),Object(u.jsx)(d.c,{googleMapsApiKey:"AIzaSyAD3EMZ4E3XEei4WDxlpEaUpiPeOCm5cIQ",children:Object(u.jsxs)(d.a,{mapContainerStyle:{width:"100%",height:"inherit"},zoom:r.zoom,center:r.center,options:{styles:m,minZoom:11,maxZoom:20,disableDefaultUI:!0},onLoad:function(e){!function(e){v.current=e}(e)},onZoomChanged:function(){var e=null;!v.current||v.current.zoom<=18?e=60:v.current.zoom>18&&(e=1),s(e)},children:[k,null!==O&&Object(u.jsx)(d.d,{position:O,zIndex:100},"userLocation"),function(){var e=!1;return!0===r.closeInfoWindow?e=!1:null!==r.selectMarker&&(e=!0),e}()&&Object(u.jsx)(d.b,{position:{lat:r.selectMarker.coordinate.lat,lng:r.selectMarker.coordinate.lng},options:{pixelOffset:new window.google.maps.Size(0,-45)},onCloseClick:function(){b({center:r.center,polygon:r.polygon,zoom:r.zoom,selectMarker:null,closeInfoWindow:!0})},children:Object(u.jsx)(j,{value:r.selectMarker})}),r.polygon&&Object(u.jsx)(d.f,{path:r.polygon,options:g})]})})]})},f=function(e){var t=e.value,a=Object(n.useState)(!0),c=Object(o.a)(a,2),s=c[0],i=c[1],r=e.setMapParameters;return"loading"===t?Object(u.jsx)("div",{className:"card loading",children:Object(u.jsx)("div",{children:"Loading..."})}):Object(u.jsxs)("div",{className:"card",children:[Object(u.jsxs)("div",{className:"card-meta",children:[Object(u.jsxs)("div",{className:"card-meta-title",children:[Object(u.jsx)("div",{className:"highlighter bgColor_mintGreen-light",style:{width:t.pipeType.length+"em"}}),Object(u.jsx)("div",{className:"state unselectable ".concat("\u662f"===t.workingState?"working":"notWorking"),children:"\u662f"===t.workingState?"\u65bd\u5de5\u4e2d":"\u672a\u65bd\u5de5"}),Object(u.jsx)("div",{className:"pipeType",style:{position:"relative"},children:t.pipeType})]}),Object(u.jsxs)("div",{className:"card-meta-basicInfo",children:[Object(u.jsxs)("div",{className:"date",children:[Object(u.jsx)("span",{className:"slash",children:t.date.start.year}),Object(u.jsx)("span",{className:"slash",children:t.date.start.month}),Object(u.jsx)("span",{children:t.date.start.day}),Object(u.jsx)("i",{className:"fas fa-caret-right fa-lg"}),Object(u.jsx)("span",{className:"slash",children:t.date.end.year}),Object(u.jsx)("span",{className:"slash",children:t.date.end.month}),Object(u.jsx)("span",{children:t.date.end.day})]}),Object(u.jsxs)("div",{className:"info",children:[Object(u.jsx)("div",{className:"item",children:"\u6848\u4ef6\u985e\u5225"}),Object(u.jsx)("div",{children:t.constructionType})]}),Object(u.jsxs)("div",{className:"info",children:[Object(u.jsx)("div",{className:"item",children:"\u5730\u9ede"}),Object(u.jsx)("div",{children:t.distriction+t.address})]})]}),Object(u.jsxs)("div",{className:"buttons",children:[0!==t.coordinate.lat&&0!==t.coordinate.lat&&Object(u.jsx)("div",{title:"\u986f\u793a\u4f4d\u7f6e",className:"buttons-locate",onClick:function(){!function(){var e=Math.random()/1e6;r({center:{lat:t.coordinate.lat+e,lng:t.coordinate.lng+e},polygon:t.coordinate.polygon,zoom:20+e,selectMarker:t,closeInfoWindow:!1})}()},children:Object(u.jsx)("i",{className:"fas fa-map-marker-alt"})}),Object(u.jsx)("div",{title:"\u66f4\u591a\u8cc7\u8a0a",className:s?"buttons-moreInfo":"buttons-moreInfoClicked",onClick:function(){i(!s)},children:Object(u.jsx)("i",{className:"fas ".concat(s?"fa-angle-double-down":"fa-angle-double-up")})})]})]}),Object(u.jsx)("div",{className:"".concat(s&&"noneDisplay"," horiLine")}),Object(u.jsx)("div",{className:"".concat(s&&"noneDisplay"," card-body"),children:Object(u.jsxs)("div",{className:"card-body-detailInfo",children:[Object(u.jsxs)("div",{className:"oneRow",children:[Object(u.jsx)("div",{className:"item",children:"\u5de5\u7a0b\u540d\u7a31"}),Object(u.jsx)("div",{className:"constructTitle",children:t.title})]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:"item",children:"\u7533\u8acb\u66f8\u7de8\u865f"}),Object(u.jsx)("div",{children:t.applicationNumber})]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:"item",children:"\u8a31\u53ef\u8b49\u7de8\u865f"}),Object(u.jsx)("div",{children:t.licenseNumber})]}),Object(u.jsxs)("div",{className:"oneRow",children:[Object(u.jsx)("div",{className:"item",children:"\u7533\u8acb\u55ae\u4f4d"}),Object(u.jsx)("div",{children:t.applicant})]}),Object(u.jsxs)("div",{className:"oneRow",children:[Object(u.jsx)("div",{className:"item",children:"\u5ee0\u5546"}),Object(u.jsx)("div",{children:t.contractor.name}),Object(u.jsx)("div",{className:"phone",children:t.contractor.phone})]}),Object(u.jsxs)("div",{className:"oneRow",children:[Object(u.jsx)("div",{className:"item",children:"\u8ca0\u8cac\u4eba"}),Object(u.jsx)("div",{children:t.personInCharge.name}),Object(u.jsx)("div",{className:"phone",children:t.personInCharge.phone})]})]})})]})},p=function(e){var t=e.handleCloseClick,a=e.handleMakerMessageClick;return Object(u.jsx)("div",{className:"closeButtonContainer",children:Object(u.jsx)("div",{className:"closeButton",onClick:function(){void 0!==t?t():void 0!==a&&a()},children:Object(u.jsx)("i",{className:"fas fa-times fa-lg"})})})},O=function(e){var t=e.margin,a=e.pageBtns,n=e.pageIndex,c=e.isMobile,s=e.handlePaginationClick,i=null,r=a.length-1,l=function(e){if(e===n)return"currentPage"};if(1===a.length)return null;if(c){var o=Array.from({length:a.length},(function(e,t){return t})),d=null;i=Object(u.jsxs)("div",{className:"pagination unselectable",children:[Object(u.jsx)("div",{className:" pageArrow",onClick:function(){s(d=n-1),d>0&&(document.getElementById("pageSelect").value=d)},children:Object(u.jsx)("i",{className:"fas fa-chevron-left"})},"prePage"),Object(u.jsxs)("div",{className:"pageElement",children:[Object(u.jsx)("i",{className:"selectArrow fas fa-chevron-down fa-lg"}),Object(u.jsx)("span",{children:n+1}),Object(u.jsx)("select",{id:"pageSelect",value:n,onChange:function(e){return s(Number(e.target.value))},children:o.map((function(e){return Object(u.jsx)("option",{value:e,children:e+1},"pageSelect_"+(e+1))}))})]}),Object(u.jsx)("div",{className:" pageArrow",onClick:function(){s(d=n+1),d<r&&(document.getElementById("pageSelect").value=d)},children:Object(u.jsx)("i",{className:"fas fa-chevron-right"})},"nextPage")]})}else if(a.length>7){if(n-0>3&&r-n>3){var j=Array.from({length:3},(function(e,t){return t+n-1}));i=Object(u.jsxs)("div",{className:"pagination unselectable ".concat(t),children:[Object(u.jsx)("div",{className:"pageElement pageArrow",onClick:function(){s(n-1)},children:Object(u.jsx)("i",{className:"fas fa-chevron-left"})},"prePage"),Object(u.jsx)("div",{onClick:function(){s(0)},className:"pageElement pageBtn ".concat(l(0)),children:1},"page-01"),Object(u.jsx)("div",{className:"pageElement dot"}),j.map((function(e){return Object(u.jsx)("div",{onClick:function(){s(e)},className:"pageElement pageBtn ".concat(l(e)),children:e+1},"page"+(e+1))})),Object(u.jsx)("div",{className:"pageElement dot"}),Object(u.jsx)("div",{onClick:function(){s(r)},className:"pageElement pageBtn ".concat(l(r)),children:r+1},"page-"+r+1),Object(u.jsx)("div",{className:"pageElement pageArrow",onClick:function(){s(n+1)},children:Object(u.jsx)("i",{className:"fas fa-chevron-right"})},"nextPage")]})}else if(n-0<=3){var m=Array.from({length:5},(function(e,t){return t}));i=Object(u.jsxs)("div",{className:"pagination unselectable ".concat(t),children:[Object(u.jsx)("div",{className:"pageElement pageArrow",style:0===n?{visibility:"hidden"}:{},onClick:function(){s(n-1)},children:Object(u.jsx)("i",{className:"fas fa-chevron-left"})},"prePage"),m.map((function(e){return Object(u.jsx)("div",{onClick:function(){s(e)},className:"pageElement pageBtn ".concat(l(e)),children:e+1},"page-"+(e+1))})),Object(u.jsx)("div",{className:"pageElement dot"}),Object(u.jsx)("div",{onClick:function(){s(r)},className:"pageElement pageBtn ".concat(l(r)),children:r+1},"page-"+r+1),Object(u.jsx)("div",{className:"pageElement pageArrow",onClick:function(){s(n+1)},children:Object(u.jsx)("i",{className:"fas fa-chevron-right"})},"nextPage")]})}else if(r-n<=3){var g=Array.from({length:5},(function(e,t){return t+r-4}));i=Object(u.jsxs)("div",{className:"pagination unselectable ".concat(t),children:[Object(u.jsx)("div",{className:"pageElement pageArrow",onClick:function(){s(n-1)},children:Object(u.jsx)("i",{className:"fas fa-chevron-left"})},"prePage"),Object(u.jsx)("div",{onClick:function(){s(0)},className:"pageElement pageBtn ".concat(l(0)),children:1},"page-01"),Object(u.jsx)("div",{className:"pageElement dot"}),g.map((function(e){return Object(u.jsx)("div",{onClick:function(){s(e)},className:"pageElement pageBtn ".concat(l(e)),children:e+1},"page-"+(e+1))})),Object(u.jsx)("div",{className:"pageElement pageArrow",style:n===r?{visibility:"hidden"}:{},onClick:function(){s(n+1)},children:Object(u.jsx)("i",{className:"fas fa-chevron-right"})},"nextPage")]})}}else i=Object(u.jsx)("div",{className:"pagination unselectable ".concat(t),children:a.map((function(e){return Object(u.jsx)("div",{onClick:function(){s(e)},className:"pageElement pageBtn ".concat(l(e)),children:e+1},"page-"+(e+1))}))});return i},v=a(39),x=a.n(v),k=a(43),y=(a(51),function(e){var t=Object(n.useState)([null,null]),a=Object(o.a)(t,2),c=a[0],s=a[1],i=Object(o.a)(c,2),r=i[0],d=i[1],j=Object(n.useState)(""),m=Object(o.a)(j,2),g=m[0],h=m[1],b=e.options,f=e.condition,p=e.mapParameters,O=e.setCondition,y=e.setPageIndex,N=e.setMapParameters,C=Object(n.useCallback)((function(){var e=document.getElementById("districtionSelect");w(e),w(e.previousElementSibling,e.value),Object(v.registerLocale)("zh-TW",k.a)}),[]);Object(n.useEffect)((function(){C()}),[C]);var w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.value;e.dataset.chosen=t},M=function(e){var t="number"===typeof e?e.toString():e;return 1===t.length&&(t="0"+t),t},S=function(){N({center:{lat:24.1512535,lng:120.6617366},polygon:null,zoom:12+Math.random()/1e4,selectMarker:p.selectMarker,closeInfoWindow:!0})},T=function(e){var t=document.getElementById(e),a=null;if(null===t)return"\u8f09\u5165\u4e2d";if(a=t.value,"workingStateSelect"===e)switch(a){case"0":a="\u5168\u6848\u4ef6";break;case"\u662f":a="\u65bd\u5de5\u4e2d";break;case"\u5426":a="\u672a\u65bd\u5de5";break;default:a="\u5168\u6848\u4ef6"}return"districtionSelect"===e&&"0"===a&&(a="\u5168\u5730\u5340"),a},P=Array.from({length:b.workingState.length},(function(e,t){return t})),I=Array.from({length:b.distriction.length},(function(e,t){return t}));return Object(u.jsxs)("div",{className:"selectors",children:[Object(u.jsxs)("div",{className:"selectContainer",children:[Object(u.jsx)("i",{className:"selectArrow fas fa-chevron-down"}),Object(u.jsxs)("select",{name:"workingState",id:"workingStateSelect",defaultValue:"\u662f",onChange:function(e){var t=f.distriction,a=0===Number(e.target.value)?0:e.target.value,n=null===f.date.start?null:Object(l.a)({},f.date.start),c=null===f.date.end?null:Object(l.a)({},f.date.end),s=g,i=f.stack;w(e.target),w(e.target.previousElementSibling,e.target.value),-1===i.indexOf("workingState")?i.push("workingState"):0===a&&(i=i.filter((function(e){return"workingState"!==e}))),S(),y(0),h(""!==s?"".concat(n.year,"/").concat(M(n.month),"/").concat(M(n.day)," - ").concat(c.year,"/").concat(M(c.month),"/").concat(M(c.day)):""),O({workingState:a,distriction:t,date:{start:null===n?null:Object(l.a)({},n),end:null===c?null:Object(l.a)({},c)},stack:i})},children:[Object(u.jsx)("option",{value:0,children:"\u5168\u6848\u4ef6"}),P.map((function(e){return Object(u.jsx)("option",{value:b.workingState[e],children:"\u662f"===b.workingState[e]?"\u65bd\u5de5\u4e2d":"\u672a\u65bd\u5de5"},b.workingState[e])}))]}),Object(u.jsx)("span",{children:T("workingStateSelect")})]}),Object(u.jsxs)("div",{className:"selectContainer",children:[Object(u.jsx)("i",{className:"selectArrow fas fa-chevron-down"}),Object(u.jsxs)("select",{name:"distriction",id:"districtionSelect",defaultValue:"0",onChange:function(e){var t=0===Number(e.target.value)?0:e.target.value,a=f.workingState,n=null===f.date.start?null:Object(l.a)({},f.date.start),c=null===f.date.end?null:Object(l.a)({},f.date.end),s=g,i=f.stack;w(e.target),w(e.target.previousElementSibling,e.target.value),-1===i.indexOf("distriction")?i.push("distriction"):0===t&&(i=i.filter((function(e){return"distriction"!==e}))),S(),y(0),h(""!==s?"".concat(n.year,"/").concat(M(n.month),"/").concat(M(n.day)," - ").concat(c.year,"/").concat(M(c.month),"/").concat(M(c.day)):""),O({workingState:a,distriction:t,date:{start:null===n?null:Object(l.a)({},n),end:null===c?null:Object(l.a)({},c)},stack:i})},"data-testing":"gg",children:[Object(u.jsx)("option",{value:0,children:"\u5168\u5730\u5340"}),I.map((function(e){return Object(u.jsx)("option",{value:b.distriction[e],children:b.distriction[e]},b.distriction[e])}))]}),Object(u.jsx)("span",{children:T("districtionSelect")})]}),Object(u.jsx)(x.a,{value:g,locale:"zh-TW",wrapperClassName:"dateSelectContainer",className:"dateSelect",placeholderText:"\u65e5\u671f\u7bc4\u570d",dateFormat:"yyyy/MM/dd",selectsRange:!0,startDate:r,endDate:d,minDate:new Date(Object.values(b.date.start)),maxDate:new Date(Object.values(b.date.end)),isClearable:!0,shouldCloseOnSelect:!1,onChange:function(e){if(s(e),null===e[0]||null!==e[1]){if(null===e[0]&&null===e[1]){var t=f.stack,a=f.distriction,n=f.workingState;return t=t.filter((function(e){return"date"!==e})),S(),h(""),void O({workingState:n,distriction:a,date:{start:null,end:null},stack:t})}var c=f.distriction,i=f.workingState,r={year:e[0].getFullYear(),month:e[0].getMonth()+1,day:e[0].getDate()},o={year:e[1].getFullYear(),month:e[1].getMonth()+1,day:e[1].getDate()},d=f.stack;-1===d.indexOf("date")&&d.push("date"),S(),y(0),h("".concat(r.year,"/").concat(M(r.month),"/").concat(M(r.day)," - ").concat(o.year,"/").concat(M(o.month),"/").concat(M(o.day))),O({workingState:i,distriction:c,date:{start:Object(l.a)({},r),end:Object(l.a)({},o)},stack:d})}else h("".concat(e[0].getFullYear(),"/").concat(M(e[0].getMonth()+1),"/").concat(M(e[0].getDate())," -"))},onFocus:function(e){return e.target.blur()}})]})}),N=function(e){var t=e.closeInfoBlock,a=e.handleCloseClick,c=e.isMobile,s=Object(n.useState)(0),i=Object(o.a)(s,2),r=i[0],l=i[1],d=Object(n.useMemo)((function(){var t=0;if(null!==e.value)return t=e.value.length>1?e.value[r].length:1===e.value.length?e.value[0].length:0,Array.from({length:t},(function(e,t){return t}))}),[e.value,r]),j=function(t){t>e.value.length-1||t<0||(document.getElementById("topAnchor").scrollIntoView(!1),l(t))},m=function(e){var t="";return!0===e?t="close":!1!==e&&null!==e||(t="open"),t};if("loading"===e.value)return Object(u.jsx)("div",{className:"infoBlockContainer",children:Object(u.jsx)("div",{className:"infoBlock",style:{paddingTop:"0",backgroundColor:"#ececec"},children:Object(u.jsx)("div",{className:"loading",children:Object(u.jsx)("i",{className:"fas fa-circle-notch fa-lg"})})})});if(null===e.value)return Object(u.jsx)("div",{className:"infoBlockContainer",children:Object(u.jsx)("div",{className:"infoBlock",children:Object(u.jsxs)("div",{className:"noContent",children:[Object(u.jsx)("div",{className:"exclamationMark",children:Object(u.jsx)("i",{className:"fas fa-exclamation-triangle fa-lg"})}),Object(u.jsx)("div",{children:"\u767c\u751f\u932f\u8aa4\uff0c\u8acb\u7a0d\u5f8c\u5728\u8a66"})]})})});if(0===e.length)return Object(u.jsx)("div",{className:"infoBlockContainer ".concat(m(t)),children:Object(u.jsxs)("div",{className:"infoBlock",children:[Object(u.jsx)(p,{handleCloseClick:a}),Object(u.jsx)("div",{className:"toolbarContainer",children:Object(u.jsx)(y,{options:e.option,condition:e.condition,mapParameters:e.mapParameters,setCondition:e.setCondition,setMapParameters:e.setMapParameters,setPageIndex:l})}),Object(u.jsx)("div",{className:"cardsListContainer",children:Object(u.jsx)("div",{className:"cardsList",children:Object(u.jsx)("div",{className:"noContent",children:"\u6c92\u6709\u7b26\u5408\u689d\u4ef6\u7684\u8cc7\u6599"})})})]})});var g=Array.from({length:e.value.length},(function(e,t){return t}));return Object(u.jsx)("div",{className:"infoBlockContainer ".concat(m(t)),children:Object(u.jsxs)("div",{className:"infoBlock",children:[Object(u.jsx)(p,{handleCloseClick:a}),Object(u.jsx)("div",{className:"toolbarContainer",children:Object(u.jsx)(y,{options:e.option,condition:e.condition,setCondition:e.setCondition,setPageIndex:l,mapParameters:e.mapParameters,setMapParameters:e.setMapParameters})}),Object(u.jsx)("div",{className:"cardsListContainer",children:Object(u.jsxs)("div",{className:"cardsList",children:[Object(u.jsx)(O,{pageBtns:g,pageIndex:r,handlePaginationClick:j,isMobile:c}),Object(u.jsx)("div",{id:"topAnchor",style:{marginBottom:"2em"}}),d.map((function(t){return Object(u.jsx)(f,{value:e.value[r][t],setMapParameters:e.setMapParameters},"card"+(10*r+t+1))})),Object(u.jsx)(O,{pageBtns:g,pageIndex:r,handlePaginationClick:j,isMobile:c})]})})]})})},C=function(e){var t=e.closeInfoBlock,a=e.makerMessage,n=e.handleCloseClick,c=e.handleMakerMessageClick,s=e.userLocation,i=e.mapParameters,r=e.setMapParameters;return Object(u.jsxs)("div",{className:"infoButtonContainer ".concat(!1!==t&&!0!==a?"open":"close"),children:[Object(u.jsx)("div",{className:"button",onClick:n,children:Object(u.jsx)("i",{className:"fas fa-search fa-lg"})}),Object(u.jsx)("div",{className:"button",onClick:function(){var e=Math.random()/1e6;r({center:{lat:s.lat+e,lng:s.lng+e},polygon:i.polygon,zoom:i.zoom,selectMarker:i.selectMarker,closeInfoWindow:!1})},style:{display:null===s?"none":""},children:Object(u.jsx)("i",{className:"fas fa-map-marker-alt fa-lg"})}),Object(u.jsx)("div",{className:"button",onClick:function(){c()},children:Object(u.jsx)("i",{className:"fas fa-info fa-lg"})})]})},w=function(e){var t=e.makerMessage,a=e.handleMakerMessageClick;return Object(u.jsx)("div",{className:"infoBlockContainer ".concat(function(e){var t="";return null===e?t="hide":!0===e?t="open":!1===e&&(t="close"),t}(t)),children:Object(u.jsxs)("div",{className:"infoBlock maker",children:[Object(u.jsx)(p,{handleMakerMessageClick:a}),Object(u.jsxs)("div",{className:"makerMessage flex",children:[Object(u.jsx)("img",{src:"/Taichung_Road_Construction_Map/img/logo.png",alt:"Kai's logo"}),Object(u.jsxs)("article",{children:[Object(u.jsx)("p",{children:"\u55e8\uff0c\u6211\u662fKai\u3002"}),Object(u.jsx)("p",{children:"\u53f0\u4e2d\u9053\u8def\u65bd\u5de5\u5730\u5716\u662f\u70ba\u4e86\u7df4\u7fd2API\u4e32\u63a5\u6240\u505a\u7684side project\u3002"}),Object(u.jsx)("p",{children:"\u9084\u6709\u5f88\u591a\u7d30\u7bc0\u9700\u8981\u6539\u9032\uff0c\u9084\u6709\u592a\u591a\u592a\u591a\u7684\u77e5\u8b58\u8981\u5b78\u7fd2\u3002\u5b78\u6d77\u7121\u6daf\uff0c\u53ea\u80fd\u7e7c\u7e8c\u7cbe\u9032\u3002"})]}),Object(u.jsx)("div",{}),Object(u.jsxs)("div",{className:"socialMedia",children:[Object(u.jsx)("a",{href:"https://github.com/TKaiC666",target:"_blank",rel:"noreferrer",children:Object(u.jsx)("i",{className:"fab fa-github fa-lg"})}),Object(u.jsx)("a",{href:"https://www.facebook.com/profile.php?id=100002803117493",target:"_blank",rel:"noreferrer",children:Object(u.jsx)("i",{className:"fab fa-facebook fa-lg"})}),Object(u.jsx)("a",{href:"https://www.instagram.com/attifmai/",target:"_blank",rel:"noreferrer",children:Object(u.jsx)("i",{className:"fab fa-instagram fa-lg"})})]})]})]})})},M=function(){var e=Object(n.useState)(null),t=Object(o.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(null),i=Object(o.a)(s,2),d=i[0],j=i[1],m=Object(n.useState)(!1),g=Object(o.a)(m,2),h=g[0],f=g[1],p=Object(n.useState)(null),O=Object(o.a)(p,2),v=O[0],x=O[1],k=Object(n.useState)("loading"),y=Object(o.a)(k,2),M=y[0],S=y[1],T=Object(n.useState)({workingState:"\u662f",distriction:0,date:{start:null,end:null},stack:["workingState"]}),P=Object(o.a)(T,2),I=P[0],B=P[1],E=Object(n.useState)({center:{lat:24.1512535,lng:120.6617366},polygon:null,zoom:12,selectMarker:null,closeInfoWindow:null}),_=Object(o.a)(E,2),z=_[0],A=_[1],D=Object(n.useCallback)((function(){L(),W(428),window.addEventListener("resize",L),window.addEventListener("resize",(function(){return W(428)})),R()}),[]),R=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){!function(e){var t={center:{lat:e.coords.latitude,lng:e.coords.longitude},polygon:null,zoom:12,selectMarker:null,closeInfoWindow:null};A(t),j(t.center)}(e)})):console.log("geolocation is not available")},L=function(){document.documentElement.style.setProperty("--vh","".concat(window.innerHeight/100,"px"))},W=function(e){var t=null;return t=window.innerWidth<=e,c(t),t},F=function(e){var t=Object.values(e),a=Object(o.a)(t,3),n=a[0],c=a[1],s=a[2];return n=n.toString(),c=c.toString(),s=s.toString(),1===c.length&&(c="0"+c),1===s.length&&(s="0"+s),parseInt(n+c+s,10)},Y=function(e){for(var t=e,a=[],n=0;n<t.length;n+=10)a.push(t.slice(n,n+10));return a},J=Object(n.useCallback)((function(){var e=function(e){var t=function(e){var t=function(e,t){var a={lat:0,lng:0};return a.lat=Number(e),a.lng=Number(t),a};return{date:{start:{year:Number(e["\u6838\u51c6\u8d77\u65e5"].substring(0,3))+1911,month:Number(e["\u6838\u51c6\u8d77\u65e5"].substring(3,5)),day:Number(e["\u6838\u51c6\u8d77\u65e5"].substring(5))},end:{year:Number(e["\u6838\u51c6\u8fc4\u65e5"].substring(0,3))+1911,month:Number(e["\u6838\u51c6\u8fc4\u65e5"].substring(3,5)),day:Number(e["\u6838\u51c6\u8fc4\u65e5"].substring(5))}},personInCharge:{name:e["\u627f\u8fa6\u4eba"].substring(0,1)+"\u25ef\u25ef"},coordinate:{lat:t(e["\u4e2d\u5fc3\u9edeY\u5750\u6a19"],e["\u4e2d\u5fc3\u9edeX\u5750\u6a19"]).lat,lng:t(e["\u4e2d\u5fc3\u9edeY\u5750\u6a19"],e["\u4e2d\u5fc3\u9edeX\u5750\u6a19"]).lng,polygon:function(e){var a=e.slice(12,e.length-2);return""===e?null:a=(a=(a=a.split(", ")).map((function(e){return e.split(" ")}))).map((function(e){return t(e[1],e[0])}))}(e["\u65bd\u5de5\u7bc4\u570d\u5750\u6a19"])}}}(e);return{title:e["\u5de5\u7a0b\u540d\u7a31"],distriction:e["\u5340\u57df\u540d\u7a31"],address:e["\u5730\u9ede"],pipeType:e["\u7ba1\u7dda\u5de5\u7a0b\u985e\u5225"],constructionType:e["\u6848\u4ef6\u985e\u5225"],workingState:e["\u662f\u5426\u958b\u5de5"],date:{start:{year:t.date.start.year,month:t.date.start.month,day:t.date.start.day},end:{year:t.date.end.year,month:t.date.end.month,day:t.date.end.day}},applicationNumber:e["\u7533\u8acb\u66f8\u7de8\u865f"],licenseNumber:e["\u8a31\u53ef\u8b49\u7de8\u865f"],applicant:e["\u7533\u8acb\u55ae\u4f4d"],contractor:{name:e["\u5ee0\u5546\u540d\u7a31"],phone:e["\u5ee0\u5546\u96fb\u8a71"]},personInCharge:{name:t.personInCharge.name,phone:e["\u627f\u8fa6\u4eba\u96fb\u8a71"]},coordinate:{lat:t.coordinate.lat,lng:t.coordinate.lng,polygon:t.coordinate.polygon}}};console.time("fetch\u82b1\u8cbb\u6642\u9593"),fetch("https://datacenter.taichung.gov.tw/swagger/OpenData/863064b3-7678-437e-9161-8dcda3d95ab7").then((function(e){if(console.timeEnd("fetch\u82b1\u8cbb\u6642\u9593"),200===e.status)return e.text();throw new Error("response was not ok.")})).then((function(t){if("["!==t[0])console.error("fetch error : \n",t),S(null);else{var a=function(t){for(var a=t,n=[],c=0;c<a.length;c++)n.push(e(a[c]));return n}(JSON.parse(t));S(a)}})).catch((function(e){console.error("fetch error : ",e.message),S(null)}))}),[]);Object(n.useEffect)((function(){D(),J()}),[D,J]);var K=Object(n.useMemo)((function(){return function(e){var t=M,a=[];if(null===t||"loading"===t)a=t;else if(3===e.stack.length)a=t.filter((function(t){return(F(e.date.start)>=F(t.date.start)&&F(e.date.start)<=F(t.date.end)||F(e.date.end)>=F(t.date.start)&&F(e.date.end)<=F(t.date.end))&&t.workingState===e.workingState&&t.distriction===e.distriction}));else if(2===e.stack.length)if(-1!==e.stack.indexOf("date")){var n=e.stack[1-e.stack.indexOf("date")];a=t.filter((function(t){return(F(e.date.start)>=F(t.date.start)&&F(e.date.start)<=F(t.date.end)||F(e.date.end)>=F(t.date.start)&&F(e.date.end)<=F(t.date.end))&&t[n]===e[n]}))}else a=t.filter((function(t){return t.workingState===e.workingState&&t.distriction===e.distriction}));else 1===e.stack.length&&(0!==e.distriction?a=t.filter((function(t){return t.distriction===e.distriction})):null!==e.date.start&&null!==e.date.end?a=t.filter((function(t){return F(e.date.start)>=F(t.date.start)&&F(e.date.start)<=F(t.date.end)||F(e.date.end)>=F(t.date.start)&&F(e.date.end)<=F(t.date.end)})):0!==e.workingState&&(a=t.filter((function(t){return t.workingState===e.workingState}))));return a}(I)}),[I,M]),Z=Object(n.useMemo)((function(){var e={workingState:[],distriction:[],date:{start:{},end:{}}};if(I.stack.length>=0&&"loading"!==M&&null!==M){e.date.start=Object(l.a)({},M[0].date.start),e.date.end=Object(l.a)({},M[0].date.end);var t,a=Object(r.a)(M);try{for(a.s();!(t=a.n()).done;){var n=t.value;-1===e.workingState.indexOf(n.workingState)&&e.workingState.push(n.workingState),-1===e.distriction.indexOf(n.distriction)&&e.distriction.push(n.distriction),F(n.date.start)<=F(e.date.start)&&(e.date.start=Object(l.a)({},n.date.start)),F(n.date.end)>=F(e.date.end)&&(e.date.end=Object(l.a)({},n.date.end))}}catch(c){a.e(c)}finally{a.f()}}return e}),[I.stack,M]),V=function(){var e=h;f(e=null!==e&&!e)},X=function(){var e=v;x(e=null===v||!e)};if("loading"===M||null===M)return Object(u.jsxs)("div",{children:[Object(u.jsx)(b,{constructionsData:null,mapParameters:z,setMapParameters:A}),Object(u.jsx)(N,{value:M})]});var U=null;return U=0===I.distriction&&null===I.date.start&&null===I.date.end&&0===I.workingState?M:K,Object(u.jsxs)("div",{className:"container",children:[Object(u.jsx)(b,{constructionsData:Y(U),mapParameters:z,closeInfoBlock:h,setMapParameters:A,makerMessage:v,isMobile:a,userLocation:d}),Object(u.jsx)(C,{closeInfoBlock:h,makerMessage:v,handleCloseClick:V,handleMakerMessageClick:X,userLocation:d,mapParameters:z,setMapParameters:A}),Object(u.jsx)(N,{value:Y(U),length:U.length,option:Z,condition:I,mapParameters:z,closeInfoBlock:h,isMobile:a,handleCloseClick:V,setCondition:B,setMapParameters:A}),Object(u.jsx)(w,{makerMessage:v,handleMakerMessageClick:X})]})};a(99),a(100);i.a.render(Object(u.jsx)(c.a.StrictMode,{children:Object(u.jsx)(M,{})}),document.getElementById("root"))},99:function(e,t,a){}},[[102,1,2]]]);
//# sourceMappingURL=main.5d8ecfd2.chunk.js.map